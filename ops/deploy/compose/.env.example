# ─────────────────────────────────────────────────────────────────────────────
# Gryt — All-in-One Docker Compose Environment
# Copy this file to .env and edit the values below.
# ─────────────────────────────────────────────────────────────────────────────

# ── Image versions ──────────────────────────────────────────────────────────
# Pin to a specific release (e.g. 1.2.3) or leave as "latest"
SERVER_VERSION=latest
SFU_VERSION=latest

# Web client (optional — only used with: docker compose --profile web up -d)
CLIENT_VERSION=latest

# ── Server settings ─────────────────────────────────────────────────────────
SERVER_NAME=My Gryt Server
SERVER_DESCRIPTION=A Gryt voice chat server
# Optional server-to-SFU shared secret (NOT a user join password).
# Leave empty unless you need to restrict SFU registrations.
SERVER_PASSWORD=

# ── Networking ──────────────────────────────────────────────────────────────
# Allowed origins for the API (comma-separated).
# Include http://127.0.0.1:15738 to allow the Electron desktop app.
# Include https://app.gryt.chat to allow the hosted web client.
# Add your own domain if you self-host the web client.
CORS_ORIGIN=http://127.0.0.1:15738,http://localhost:3666,https://app.gryt.chat

# Public URL(s) of the SFU that browsers connect to (ws:// or wss://).
# Comma-separated for multi-network (e.g. LAN + public). The client
# pings each endpoint and picks the fastest one automatically.
SFU_PUBLIC_HOST=ws://localhost:5005

# ── Ports ───────────────────────────────────────────────────────────────────
CLIENT_PORT=3666
SERVER_PORT=5000
SFU_PORT=5005

# SFU UDP range for WebRTC media — open these ports in your firewall
SFU_UDP_MIN=10000
SFU_UDP_MAX=10019

# Recommended: run WebRTC over a single UDP port (better on restrictive networks).
# Open/allow this UDP port to the SFU host (e.g. AWS Security Group + host firewall).
ICE_UDP_MUX_PORT=443

# Public IP to advertise in ICE candidates. Set this if the SFU is behind NAT.
# For LAN setups: use your server's local IP so clients connect directly
# (near-zero latency — no external STUN needed).
# For mixed LAN + internet: comma-separate both IPs.
# SFU_ADVERTISE_IP=192.168.1.100
# SFU_ADVERTISE_IP=203.0.113.10,192.168.1.100

# ── STUN servers ────────────────────────────────────────────────────────────
STUN_SERVERS=stun:stun.l.google.com:19302,stun:stun1.l.google.com:19302

# ── Security ────────────────────────────────────────────────────────────────
# IMPORTANT: Change this in production! Generate with: openssl rand -base64 48
JWT_SECRET=change-me-in-production

# ── Authentication ──────────────────────────────────────────────────────────
# Set to "required" to require Gryt accounts.
# Set to "disabled" to reject all joins (lock the server).
GRYT_AUTH_MODE=disabled
GRYT_OIDC_ISSUER=https://auth.gryt.chat/realms/gryt
GRYT_OIDC_AUDIENCE=gryt-web
GRYT_AUTH_API=https://auth.gryt.chat
GRYT_OIDC_REALM=gryt
GRYT_OIDC_CLIENT_ID=gryt-web

# ── ScyllaDB ────────────────────────────────────────────────────────────────
SCYLLA_KEYSPACE=gryt

# ── MinIO (S3-compatible storage) ───────────────────────────────────────────
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin
S3_BUCKET=gryt
